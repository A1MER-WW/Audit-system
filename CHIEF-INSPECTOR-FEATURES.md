# หน้าภาพรวมการประเมินความเสี่ยงสำหรับหัวหน้าผู้ตรวจสอบ

## ภาพรวม
หน้าใหม่นี้ถูกสร้างขึ้นสำหรับหัวหน้าผู้ตรวจสอบโดยเฉพาะ พัฒนาต่อยอดจากหน้า `overview-of-the-assessment-results` แต่เพิ่มฟีเจอร์การเปรียบเทียบข้อมูลระหว่างปีงบประมาณ

## เส้นทางการเข้าถึง
- **URL**: `/chief-inspector-assessment-results`
- **ไฟล์**: `app/chief-inspector-assessment-results/page.tsx`

## ฟีเจอร์หลัก

### 1. การแสดงผลแบบเดิม
- แสดงผลกราฟโดนัทและแท่งซ้อนสำหรับปีปัจจุบัน (2568)
- รองรับการกรองและเรียงลำดับข้อมูล
- แสดงตารางข้อมูลตามแท็บต่างๆ (สรุป, จัดลำดับ, ระดับหน่วยงาน)

### 2. การเปรียบเทียบปีงบประมาณ (ใหม่)
- ปุ่ม "เปรียบเทียบปีงบประมาณ" ที่ด้านบนขวา
- Dropdown เลือกปีที่ต้องการเปรียบเทียบ (2567, 2566, 2565)
- แสดงกราฟแบบเคียงข้างกัน 4 คอลัมน์:
  - โดนัทปีปัจจุบัน (สีน้ำเงิน)
  - โดนัทปีเปรียบเทียบ (สีส้ม)
  - แท่งซ้อนปีปัจจุบัน (สีน้ำเงิน)
  - แท่งซ้อนปีเปรียบเทียบ (สีส้ม)

### 3. แท็บเปรียบเทียบ
- แท็บใหม่ "เปรียบเทียบปีงบประมาณ" ในแถบเครื่องมือ
- ตารางเปรียบเทียบแบบ side-by-side
- สรุปการเปลี่ยนแปลงพร้อมเปอร์เซ็นต์
- การเปลี่ยนแปลงตามระดับความเสี่ยง (เกรด E, H, M, L, N)

## Component ที่ได้รับการอัปเดต

### 1. `SummaryToolbar`
- เพิ่ม `OuterTab` ใหม่: `"compare"`
- เพิ่ม props `showCompareTab` สำหรับแสดงแท็บเปรียบเทียบ

### 2. `DashboardSection`
- เพิ่ม props `compareYear`, `showCompare`
- รองรับการแสดงกราฟแบบเปรียบเทียบ
- ดึงข้อมูลจาก API ของปีเปรียบเทียบ

### 3. `RiskAssessmentResultsSectionPage`
- เพิ่ม props `showCompare`, `compareYear`, `currentYear`
- เพิ่ม `CompareSection` component ใหม่
- รองรับแท็บ `"compare"`

### 4. Components ใหม่
- `CompareSection`: แสดงการเปรียบเทียบหลัก
- `CompareTable`: ตารางสถิติของแต่ละปี
- `ComparisonSummary`: สรุปการเปลี่ยนแปลงและสถิติ

## การใช้งาน

### สำหรับผู้ใช้
1. เข้าไปที่หน้า "ภาพรวมการประเมินความเสี่ยง (หัวหน้า)" จาก Sidebar
2. ดูข้อมูลปีปัจจุบัน (2568) ในโหมดปกติ
3. คลิก "เปรียบเทียบปีงบประมาณ" เพื่อเปิดโหมดเปรียบเทียบ
4. เลือกปีที่ต้องการเปรียบเทียบจาก Dropdown
5. ดูกราฟแบบเคียงข้างกัน
6. คลิกแท็บ "เปรียบเทียบปีงบประมาณ" เพื่อดูตารางเปรียบเทียบ

### สำหรับนักพัฒนา
```tsx
// การใช้งานพื้นฐาน
<ChiefInspectorAssessmentResultsPage />

// การส่ง props แบบกำหนดเอง
<DashboardSection
  year={2568}
  compareYear={2567}
  showCompare={true}
  // ... props อื่นๆ
/>

<RiskAssessmentResultsSectionPage
  outerTab="compare"
  showCompare={true}
  compareYear={2567}
  currentYear={2568}
  // ... props อื่นๆ
/>
```

## API Endpoints
- ใช้ API เดิม: `/api/chief-risk-assessment-results?year=${year}`
- ดึงข้อมูลหลายปีพร้อมกัน สำหรับการเปรียบเทียบ

## การจัดการ State
- `selectedYear`: ปีปัจจุบันที่แสดง (default: 2568)
- `compareYear`: ปีที่เปรียบเทียบ (default: 2567)
- `showCompareView`: สถานะการแสดงโหมดเปรียบเทียบ
- `outerTab`: แท็บที่เลือก รวม `"compare"` ใหม่

## การ Responsive
- Mobile: กราฟแสดงแบบ 1 คอลัมน์
- Tablet: แสดงแบบ 2 คอลัมน์
- Desktop: แสดงแบบ 4 คอลัมน์เมื่อเปรียบเทียบ

## หมายเหตุสำคัญ
- หน้านี้สืบทอดการทำงานทั้งหมดจากหน้าเดิม
- เพิ่มเฉพาะฟีเจอร์การเปรียบเทียบปีงบประมาณ
- ใช้สีน้ำเงินสำหรับปีปัจจุบัน และสีส้มสำหรับปีเปรียบเทียบ
- รองรับการกรองและการเรียงลำดับเหมือนเดิม